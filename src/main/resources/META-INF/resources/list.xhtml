<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core">

<h:head>
    <title>Lista pracowników</title>
</h:head>

<h:body>
    <h:form id="list">
        <p:growl id="growl" life="2000"/>


        <p:panel header="Lista pracowników">
            <p:dataTable value="#{employeeList.list}" var="employee">
                <p:column headerText="Imie">
                    <h:outputText value="#{employee.firstName}"/>
                </p:column>
                <p:column headerText="Nazwisko">
                    <h:outputText value="#{employee.lastName}"/>
                </p:column>
                <p:column headerText="Rok urodzenia">
                    <h:outputText value="#{employee.birthYear}"/>
                </p:column>
                <p:column headerText="Stanowisko">
                    <h:outputText value="#{employee.position}"/>
                </p:column>
                <p:column headerText="Wynagrodzenie">
                    <h:outputText value="#{employee.salary} PLN"/>
                </p:column>
                <p:column headerText="" style="width:300px;text-align: center">

                    <!-- usuwanie -->
                    <p:commandButton value="Usuń" id="delete" update="list"
                                     action="${employeeList.deleteEmployee(employee.id)}">
                    </p:commandButton>

                    <!-- edycja -->
                    <p:commandButton value="Edytuj" update="updateForm" onclick="PF('popupUpdate').show()"
                                     action="${employeeList.loadToUpdate(employee.id)}"/>

                    <!-- wyświetlenie zadań -> overlay panel -->
                    <p:commandButton update="tasks" oncomplete="PF('taskList').show()" icon="pi pi-search" title="Zadania" >
                        <f:setPropertyActionListener value="" target="" />
                    </p:commandButton>


                </p:column>
            </p:dataTable>

        </p:panel>

        <p:panel>
            <p:commandButton value="Dodaj pracownika" type="button" onclick="PF('popupNew').show();"/>
        </p:panel>


    </h:form>

    <!-- Dodanie nowego pracownika -->
    <p:dialog id="addNewPopup" header="Dodaj Pracownika" widgetVar="popupNew" modal="true" height="300">
        <h:form id="addNewForm">
            <p:panel>
                <h:panelGrid columns="2">
                    <h:outputLabel value="Imie:"/>
                    <p:inputText value="#{employeeList.newEmployee.firstName}" required="true" maxlength="15"/>
                    <h:outputLabel value="Nazwisko:"/>
                    <p:inputText value="#{employeeList.newEmployee.lastName}" required="true" maxlength="15"/>
                    <h:outputLabel value="Rok urodzenia:"/>
                    <p:inputText value="#{employeeList.newEmployee.birthYear}" required="true"/>
                    <h:outputLabel value="Stanowisko:"/>
                    <p:inputText value="#{employeeList.newEmployee.position}" required="true" maxlength="15"/>
                    <h:outputLabel value="Wynagrodzenie:"/>
                    <p:inputText value="#{employeeList.newEmployee.salary}" required="true"/>

                </h:panelGrid>

                <p:commandButton value="Dodaj" id="ajax" update="list,addNewPopup"
                                 action="#{employeeList.addNewEmployee}"
                                 onclick="PF('popupNew').close();"/>

            </p:panel>
        </h:form>
    </p:dialog>

    <!-- Edycja danych pracownika -->
    <p:dialog id="updatePopup" header="Edytuj Pracownika" widgetVar="popupUpdate" modal="true" height="300">
        <h:form id="updateForm">
            <p:panel>
                <h:panelGrid columns="2">
                    <h:outputLabel value="Imie:"/>
                    <p:inputText value="#{employeeList.updateEmployee.firstName}" required="true" maxlength="15"/>
                    <h:outputLabel value="Nazwisko:"/>
                    <p:inputText value="#{employeeList.updateEmployee.lastName}" required="true" maxlength="15"/>
                    <h:outputLabel value="Rok urodzenia:"/>
                    <p:inputText value="#{employeeList.updateEmployee.birthYear}" required="true"/>
                    <h:outputLabel value="Stanowisko:"/>
                    <p:inputText value="#{employeeList.updateEmployee.position}" required="true" maxlength="15"/>
                    <h:outputLabel value="Wynagrodzenie:"/>
                    <p:inputText value="#{employeeList.updateEmployee.salary}" required="true"/>

                </h:panelGrid>

                <p:commandButton value="Dodaj" id="ajax" update="list,updatePopup"
                                 action="#{employeeList.updateEmployee}"
                                 onclick="PF('popupUpdate').close();"/>

            </p:panel>
        </h:form>
    </p:dialog>

    <!-- Wyświetlanie zadań -->
    <p:overlayPanel widgetVar="taskList" showEffect="fade" hideEffect="fade" dismissable="false" showCloseIcon="true">
        <p:outputPanel id="tasks" style="">
            <p:panel header="Lista zadań">
                <p:dataTable value="#{employeeList.tasks}" var="task">
                    <p:column headerText="Nazwa">
                        <h:outputText value="#{task.name}"/>
                    </p:column>
                    <p:column headerText="Data">
                        <h:outputText value="{task.date}"/>
                    </p:column>
                    <p:column headerText="Zrobione?">
                        <h:outputText value="{task.done}"/>
                    </p:column>

                    <p:column headerText="" style="width:300px;text-align: center">

                        <!-- usuwanie -->
                        <p:commandButton value="Usuń" id="delete" update="" />


                        <!-- edycja -->
                        <p:commandButton value="Edytuj" update="" onclick=""/>



                    </p:column>
                </p:dataTable>

            </p:panel>

            <p:panel>
                <p:commandButton value="Dodaj zadanie" type="button" onclick=""/>
            </p:panel>



        </p:outputPanel>
    </p:overlayPanel>


</h:body>
</html>
